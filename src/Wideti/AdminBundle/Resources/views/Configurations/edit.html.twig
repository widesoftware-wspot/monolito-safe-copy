{% extends 'AdminBundle::layout.html.twig' %}

{% block css %}
    {{ parent() }}
    <link href="{{ asset('bundles/admin/theme/scripts/plugins/color/farbtastic/farbtastic.css') }}" rel="stylesheet"/>
    <link rel="stylesheet" type="text/css"
          href="{{ asset('bundles/admin/theme/scripts/plugins/forms/bootstrap-fileinput/bootstrap-fileinput.css') }}"/>
{% endblock %}

{% block content %}
    {% include 'AdminBundle::header.html.twig' with {title: 'Configurações do Grupo: ' ~ group.groupName} %}

    <div class="innerLR">

        <div class="widget widget-tabs border-bottom-none">

            <div class="widget-body">
                {% form_theme form 'AdminBundle:Form:configForm.html.twig' %}
                {{ form_start(form, {'attr': {'novalidate':'novalidate'} }) }}

                <div class="tabsbar">
                    <ul>
                        {% if 'auth_social' in groups %}
                            <li class="glyphicons group active"><a href="#tab1" data-toggle="tab"><i></i><span>Login e Cadastro</span></a></li>
                        {% endif %}

                        <li class="glyphicons settings"><a href="#tab2" data-toggle="tab"><i></i><span>Parâmetros</span></a></li>

                        {% if 'signup_confirmation' in groups %}
                            <li class="glyphicons check"><a href="#tab3" data-toggle="tab"><i></i><span>Confirmação de cadastro</span></a></li>
                        {% endif %}

                        <li class="glyphicons notes"><a href="#tab4" data-toggle="tab"><i></i><span>Termos de Uso</span></a></li>
                    </ul>
                </div>

                <div class="tab-content">
                    {% if 'auth_social' in groups %}
                        <div class="tab-pane active" id="tab1">
                            {% if client.getNoRegisterFields() != 0 %}
                            <br>
                            <div>
                                <span style="color: #ff0000; font-weight: bold;">Aviso:</span> O captive portal foi configurado para não exibir <strong>nenhum campo de cadastro/login</strong>. Dessa forma, <strong>não é possível</strong> configurar nenhuma ação por aqui.
                            </div>
                            <br>
                            {% endif %}

                            <div class="row-fluid">

                                <div class="span12">
                                    <div class="widget row-fluid">
                                        <div class="widget-head">
                                            <h4 class="heading"> Opções de autenticação/cadastro</h4>
                                        </div>
                                        <div class="widget-body row-fluid">
                                            <div class="span3">
                                                <div class="control-group">
                                                    Formulário de Login:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           data-content="Quando desativado, não será exibido o formulário de login para o visitante.<br>Normalmente utilizado quando se deseja liberar apenas autenticação via Redes Sociais."></i>
                                                    </span>
                                                    <div class="controls">{{ form_widget(form.login_form) }}</div>
                                                </div>
                                            </div>

                                            <div class="span3">
                                                <div class="control-group">
                                                    Formulário de Cadastro:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           data-content="Quando desativado, não será exibido o formulário de cadastro para o visitante.<br>Normalmente utilizado quando se deseja liberar apenas autenticação via Redes Sociais ou cadastro manual pela Área Administrativa."></i>
                                                    </span>
                                                    <div class="controls">{{ form_widget(form.signup_form) }}</div>
                                                </div>
                                            </div>

                                            <div class="span3">
                                                <div class="control-group">
                                                    Dispositivo Único por Cadastro:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           data-content="Esta funcionalidade permite que apenas um cadastro seja realizado por dispositivo (MAC Address) do usuário.<br>Caso já exista um cadastro uma mensagem será exibida para o usuário indicando que já existe um cadastro para o seu dispositivo"></i>
                                                    </span>
                                                    <div class="controls">{{ form_widget(form.unique_device_per_mac) }}</div>
                                                </div>
                                            </div>
                                            {% if form.age_restriction is defined %}
                                                <div class="span3">
                                                    <div class="control-group">
                                                        Restrição de idade:
                                                        <span class="tooltip-wrapper">
                                                            <i class="icon-large icon-question-sign" tabindex="0" data-placement="bottom" role="button" data-toggle="popover" data-trigger="focus" data-html="true" data-content="Regra para menores de 18 anos não acessarem o wifi.<br><br>Automaticamente quando esse recurso estiver ATIVADO, é adicionado o campo obrigatório de data de nascimento ao formulário de cadastro para realizar a validação da idade do usuário no momento do cadastro."></i>
                                                        </span>
                                                        <div class="controls">{{ form_widget(form.age_restriction) }}</div>
                                                        <div class="age-restriction-info hide">
                                                            <p>Idade mínima permitida:</p>
                                                            <input type="text" value="+18 anos" disabled class="input-small">
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endif %}

                                        </div>
                                        <div class="widget-body row-fluid">
                                            <div class="span3">
                                                <div class="control-group">
                                                    Facebook:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           {% if client.isWhiteLabel %}
                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Facebook."></i>
                                                           {% else %}
                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Facebook.<br><br>Para o correto funcionamento dessa funcionalidade é necessário que o equipamento seja configurado <a href='https://suporte.mambowifi.com/support/solutions/articles/16000101235-walled-garden-para-login-via-redes-sociais-p%C3%A1ginas-liberadas-no-hotspot-' target='_blank'>conforme instruções em nosso blog.</a>"></i>
                                                           {% endif %}
                                                    </span>
                                                    <div class="controls">{{ form_widget(form.facebook_login) }}</div>
                                                </div>
                                            </div>

                                            <div class="span3">
                                                <div class="control-group">
                                                    Twitter:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           {% if client.isWhiteLabel %}
{#                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Twitter."></i>#}
                                                               data-content="Este recurso está temporariamente desabilitado."></i>
                                                           {% else %}
{#                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Twitter.<br><br>Para o correto funcionamento dessa funcionalidade é necessário que o equipamento seja configurado <a href='https://suporte.mambowifi.com/support/solutions/articles/16000101235-walled-garden-para-login-via-redes-sociais-p%C3%A1ginas-liberadas-no-hotspot-' target='_blank'>conforme instruções em nosso blog.</a>"></i>#}
                                                               data-content="Este recurso está temporariamente desabilitado."></i>
                                                           {% endif %}
                                                    </span>
{#                                                    <div class="controls">{{ form_widget(form.twitter_login) }}</div>#}
                                                </div>
                                            </div>

                                            <div class="span3">
                                                <div class="control-group">
                                                    Google:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           {% if client.isWhiteLabel %}
                                                                data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Google."></i>
                                                           {% else %}
                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do Google.<br><br>Para o correto funcionamento dessa funcionalidade é necessário que o equipamento seja configurado <a href='https://suporte.mambowifi.com/support/solutions/articles/16000101235-walled-garden-para-login-via-redes-sociais-p%C3%A1ginas-liberadas-no-hotspot-' target='_blank'>conforme instruções em nosso blog.</a>"></i>
                                                           {% endif %}

                                                    </span>
                                                    <div class="controls">{{ form_widget(form.google_login) }}</div>
                                                </div>
                                            </div>

                                            <div class="span3">
                                                <div class="control-group">
                                                    LinkedIn:
                                                    <span class="tooltip-wrapper">
                                                        <i class="icon-large icon-question-sign" tabindex="0"
                                                           data-placement="bottom" role="button" data-toggle="popover"
                                                           data-trigger="focus" data-html="true"
                                                           {% if client.isWhiteLabel %}
                                                                data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do LinkedIn."></i>
                                                           {% else %}
                                                               data-content="Permitir que as autenticações (cadastro/login) sejam realizadas utilizando a conta do LinkedIn.<br><br>Para o correto funcionamento dessa funcionalidade é necessário que o equipamento seja configurado <a href='https://suporte.mambowifi.com/support/solutions/articles/16000101235-walled-garden-para-login-via-redes-sociais-p%C3%A1ginas-liberadas-no-hotspot-' target='_blank'>conforme instruções em nosso blog.</a>"></i>
                                                           {% endif %}

                                                    </span>
                                                    <div class="controls">{{ form_widget(form.linkedin_login) }}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row-fluid facebookFields {{ (form.vars.data.facebook_login.value is defined and form.vars.data.facebook_login.value == true or config.facebook_login == 1) ? '' : 'hide' }}">
                                <div class="span12">
                                    <div class="widget row-fluid">

                                        <div class="widget-head">
                                            <h4 class="heading">
                                                Compartilhar e Curtir no Facebook
                                            </h4>
                                            <span class="tooltip-wrapper">
                                                <i class="icon-large icon-question-sign" tabindex="0"
                                                   data-placement="bottom" role="button" data-toggle="popover"
                                                   data-trigger="focus" data-html="true"
                                                   data-content="Ativando essa funcionalidade, após a autenticação de seus clientes ou visitantes será sugerido um compartilhamento."></i>
                                            </span>
                                        </div>

                                        <div class="widget-body">

                                            <div class="row-fluid">
                                                <div class="span3">
                                                    <div class="control-group">
                                                        Compartilhar:
                                                        <div class="controls">{{ form_widget(form.facebook_share) }}</div>
                                                    </div>
                                                </div>

                                                <div class="span9">
                                                    <div class="control-group checkinFields">
                                                        Hashtag que será compartilhada
                                                        <i class="icon-large icon-question-sign"
                                                            tabindex="0"
                                                            data-placement="top"
                                                            role="button"
                                                            data-toggle="popover"
                                                            data-trigger="focus"
                                                            data-content="Escolha uma hashtag para ser incluída no momento que o visitante compartilha a publicação. Essa hashtag será inserida automaticamente no post. Ex.: #minhaEmpresa <br><b>OBS:Este texto não aparecerá no navegador padrão aberto pelos dispositivos Android no momento do login na rede</b>"
                                                            data-html="true">
                                                        </i>
                                                        <div class="controls">
                                                            {{ form_widget(form.facebook_share_hashtag) }}
                                                            <p class="text-warning">Ex: <b>#minhaEmpresa</b></p>
                                                        </div>
                                                        <span class="label label-important label-facebook-page"></span>
                                                    </div>
                                                    <div class="control-group checkinFields">
                                                        Mensagem de compartilhamento
                                                        <i class="icon-large icon-question-sign"
                                                            tabindex="0"
                                                            data-placement="top"
                                                            role="button"
                                                            data-toggle="popover"
                                                            data-trigger="focus"
                                                            data-content="Esta mensagem será adicionada como forma de citação na mensagem compartilhada pelo visitante.<br><b>OBS:Este texto não aparecerá no navegador padrão aberto pelos dispositivos Android no momento do login na rede</b>"
                                                            data-html="true">
                                                        </i>
                                                        <div class="controls">{{ form_widget(form.facebook_share_message) }}</div>
                                                    </div>
                                                    <div class="control-group checkinFields">
                                                        URL que será compartilhada
                                                        <i class="icon-large icon-question-sign"
                                                            tabindex="0"
                                                            data-placement="top"
                                                            role="button"
                                                            data-toggle="popover"
                                                            data-trigger="focus"
                                                            data-content="A URL de compartilhamento pode ser um site qualquer ou uma página do Facebook, caso seja uma página do Facebook a Mensagem de compartilhamento não será apresentada">
                                                        </i>
                                                        <div class="controls">
                                                            {{ form_widget(form.facebook_share_url) }}
                                                            <p class="text-warning">Ex: <b>https://www.minhaempresa.com.br</b>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row-fluid">
                                                <div class="span12">
                                                    <hr style="border: #d6d3d2 1px dashed"/>
                                                </div>
                                            </div>

                                            <div class="row-fluid">
                                                <div class="span3">
                                                    <div class="control-group">
                                                        Curtir (Like):
                                                        <div class="controls">{{ form_widget(form.facebook_like) }}</div>
                                                    </div>
                                                </div>

                                                <div class="span9">
                                                    <div>
                                                        <div class="control-group likeFields">
                                                            URL página do facebook para Like:
                                                            <i class="icon-large icon-question-sign"
                                                                tabindex="0"
                                                                data-placement="top"
                                                                role="button"
                                                                data-toggle="popover"
                                                                data-trigger="focus"
                                                                data-content="Esta URL precisa ser uma página da empresa no facebook, para carregar de forma adequada a caixa de Like. Ex.: https://facebook.com/minhEmpresa">
                                                            </i>
                                                            <div class="controls">
                                                                {{ form_widget(form.facebook_like_url) }}
                                                                <p class="text-warning">Ex: <b>https://facebook.com/minhaPagina</b></p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row-fluid">
                                <div class="span12">
                                    <div class="widget row-fluid">
                                        <div class="widget-head">
                                            <h4 class="heading">Login com 1-click</h4>
                                            <span class="tooltip-wrapper">
                                                <i class="icon-large icon-question-sign" tabindex="0"
                                                   data-placement="bottom" role="button" data-toggle="popover"
                                                   data-trigger="focus" data-html="true"
                                                   {% if client.isWhiteLabel %}
                                                       data-content="Com essa funcionalidade o seu cliente ou visitante terá muito mais facilidade para se conectar após o segundo acesso, pois com apenas 1-click ele já estará navegando.<br><br><strong>Os sistemas com versões iOS 14, Android 10, Windows 10 e superiores possuem o recurso de Mac Address randomizado, que pode impactar o uso desta funcionalidade.<strong>"></i>
                                                   {% else %}
                                                       data-content="Com essa funcionalidade o seu cliente ou visitante terá muito mais facilidade para se conectar após o segundo acesso, pois com apenas 1-click ele já estará navegando. Mais informações em: <a target='_blank' href='https://suporte.mambowifi.com/support/solutions/articles/16000069504-login-com-1-click'><strong>Como ativar funcionalidade de login com 1 click.</strong></a><br><br><strong>Os sistemas com versões iOS 14, Android 10, Windows 10 e superiores possuem o recurso de Mac Address randomizado, que pode impactar o uso desta funcionalidade.<strong><br><a href='https://suporte.mambowifi.com/pt-BR/support/solutions/articles/16000100471-bloqueio-de-dispositivos' target='_blank'>Saiba mais<a/>"></i>
                                                   {% endif %}

                                            </span>
                                        </div>

                                        <div class="widget-body">
                                            <div class="span12">
                                                <div class="control-group">
                                                    <div class="controls">{{ form_widget(form.auto_login) }}</div>
                                                </div>

                                                <div class="auto-login">
                                                    <div class="control-group auto-login {% if(config.auto_login == 0) %}hide{% endif %}">
                                                        Período para login com 1-click:
                                                        <span class="tooltip-wrapper">
                                                            <i class="icon-large icon-question-sign" tabindex="0"
                                                               data-placement="bottom" role="button" data-toggle="popover"
                                                               data-trigger="focus" data-html="true"
                                                               data-content="O período é contabilizado a partir do último acesso do visitante à rede."></i>
                                                        </span>
                                                                    <div class="controls">{{ form_widget(form.auto_login_days) }}</div>
                                                    </div>

                                                    <div class="control-group auto-login {% if(config.auto_login == 0) %}hide{% endif %}">
                                                        Mensagem de boas vindas (Português):
                                                        <div class="controls">{{ form_widget(form.auto_login_text_pt) }}</div>
                                                    </div>

                                                    <div class="control-group auto-login {% if(config.auto_login == 0) %}hide{% endif %}">
                                                        Mensagem de boas vindas (English):
                                                        <div class="controls">{{ form_widget(form.auto_login_text_en) }}</div>
                                                    </div>

                                                    <div class="control-group auto-login {% if(config.auto_login == 0) %}hide{% endif %}">
                                                        Texto de boas vindas (Español):
                                                        <div class="controls">{{ form_widget(form.auto_login_text_es) }}</div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    {% endif %}

                    <div class="tab-pane row-fluid" id="tab2">
                        <h4>Definições</h4><br>
                        <div class="span4">
                            <div class="control-group">
                                Nome da Empresa:
                                <span class="tooltip-wrapper">
                                    <i class="icon-large icon-question-sign" tabindex="0"
                                       data-placement="bottom" role="button" data-toggle="popover"
                                       data-trigger="focus" data-html="true"
                                       data-content="Indicamos que o nome da empresa não ultrapasse 50 caracteres, pois esse valor é utilizado no texto enviado via SMS para confirmação de cadastro. Isso evitará que o texto da SMS ultrapasse o limite de 160 caracteres."></i>
                                </span>

                                <div class="controls">{{ form_widget(form.partner_name) }}</div>
                                <p id="smsValidate"></p>
                            </div>

                            <div class="control-group">
                                URL de redirecionamento após login:
                                <div class="controls">{{ form_widget(form.redirect_url) }}</div>
                                <span style="color: red; position: relative; bottom: 5px;">(Ex. http://www.google.com)</span>
                            </div>

                            <div class="control-group">
                                Remetente dos e-mails enviados para visitantes:
                                <span class="tooltip-wrapper">
                                    <i class="icon-large icon-question-sign" tabindex="0"
                                       data-placement="bottom" role="button" data-toggle="popover"
                                       data-trigger="focus" data-html="true"
                                       data-content="Para alterar esse e-mail, é necessário validá-lo. Após inserir o novo e-mail, você receberá uma mensagem da AWS. Clique no link para confirmar que o e-mail é válido."></i>
                                </span>
                                <div class="controls">{{ form_widget(form.from_email) }}</div>
                            </div>
                        </div>

                        <div class="span3">
                            <div class="control-group">
                                Multi-idiomas (PT/EN/ES):
                                <div class="controls">{{ form_widget(form.translation) }}</div>
                            </div>

                            <div class="control-group">
                                Credenciais via SMS:
                                {% if isSmsPocLimited %}
                                    <p style="color: red;">Limite de {{ maxNumberSmsSendingPoc }} SMS atingido. Essa opção não pode ser habilitada.</p>
                                    <div class="controls" style="display:none;">{{ form_widget(form.enable_welcome_sms) }}</div>
                                {% else %}
                                    <div class="controls">{{ form_widget(form.enable_welcome_sms) }}</div>
                                {% endif %}
                            </div>

                            <div class="control-group">
                                E-mail de boas-vindas:
                                <div class="controls">{{ form_widget(form.enable_welcome_email) }}</div>
                            </div>
                        </div>

                        <div class="span4">
                            <div class="control-group">
                                Solicitar opt-in dos visitantes:
                                <div class="controls">{{ form_widget(form.authorize_email) }}</div>
                            </div>

                            <div class="control-group authorize-email">
                                Opção obrigatória para prosseguir?
                                <span class="tooltip-wrapper">
                                    <i class="icon-large icon-question-sign" tabindex="0" data-placement="bottom"
                                       role="button" data-toggle="popover" data-trigger="focus" data-html="true"
                                       data-content="Caso queira que seja obrigatório o visitante selecionar o opt-in, escolha Sim. Caso contrário o cadastro será liberado mesmo se ele não preencher a opção."></i>
                                </span>
                                <div class="controls">{{ form_widget(form.request_optin) }}</div>
                            </div>

                            <div class="control-group authorize-email">
                                Mensagem (Português):
                                <div class="controls">{{ form_widget(form.content_authorize_email_pt) }}</div>
                            </div>

                            <div class="control-group authorize-email">
                                Message (English):
                                <div class="controls">{{ form_widget(form.content_authorize_email_en) }}</div>
                            </div>

                            <div class="control-group authorize-email">
                                Mensaje (Español):
                                <div class="controls">{{ form_widget(form.content_authorize_email_es) }}</div>
                            </div>
                            <div class="control-group authorize-email">
                                <span style="color: red; position: relative; bottom: 5px;">Ao realizar a inclusão de links, a URL deverá fazer parte da lista autorizada no Walled Garden do equipamento</span>
                            </div>
                            </div>
                    </div>

                    {% if 'signup_confirmation' in groups %}
                        <div class="tab-pane row-fluid" id="tab3">
                            <h4>Confirmação de cadastro</h4>
                            <br>

                            <div class="control-group">
                                Habilitar confirmação de cadastro:
                                <div class="controls">{{ form_widget(form.enable_confirmation) }}</div>
                            </div>

                            <div class="signUpConfirmation {% if(config.enable_confirmation == 0) %}hide{% endif %}">
                                <p>Selecione a opção de confirmação de cadastro que deseja:</p>
                                {% if isSmsPocLimited %}
                                    <p style="color: red;">Confirmação via SMS não pode ser habilitada pois o limite de {{ maxNumberSmsSendingPoc }} envios durante o teste foi atingido.</p>
                                {% endif %}

                                <div class="control-group">
                                    <div class="controls">
                                        <div data-toggle="buttons-radio" class="btn-group">
                                            {% if isSmsPocLimited %}
                                                <button id="signUpSMS" class="btn btn-primary sms disabled" type="button">SMS</button>
                                            {% else %}
                                                <button id="signUpSMS" class="btn btn-primary sms {% if(config.confirmation_sms == 1) %}active{% endif %}" type="button">SMS</button>
                                            {% endif %}
                                            <button class="btn btn-primary email {% if(config.confirmation_email == 1) %}active{% endif %}" type="button">E-mail</button>
                                        </div>
                                        <div id="sms-log" style="display:none;"></div>
                                    </div>
                                </div>

                                <br>

                                <div class="row-fluid email">
                                    <div class="control-group">
                                        Tempo limite para confirmação:
                                        <i class="icon-large icon-question-sign" tabindex="0" data-placement="top"
                                           role="button" data-toggle="popover" data-trigger="focus"
                                           data-content="Neste campo deverá ser configurado o tempo em que o visitante terá acesso à Internet, após o cadastro, para que acesse seu e-mail e siga as instruções de confirmação de cadastro."></i>
                                        <div class="controls">
                                            {{ form_widget(form.confirmation_email_limit_time) }}
                                            <span style="color: red; position: relative; bottom: 5px;">(Ex. 4d 12h 5m)</span>
                                            <div><span style="color: orange;">Obs: Recomenda-se o tempo de 5m ou 10m</span></div>
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        Tempo de bloqueio:
                                        <i class="icon-large icon-question-sign" tabindex="0" data-placement="top"
                                           role="button" data-toggle="popover" data-trigger="focus"
                                           data-content="Neste campo deverá ser configurado o tempo em que o visitante deverá esperar até realizar uma nova tentativa de confirmação, cadastro ou acesso. O visitante terá novamente o tempo definido no campo 'Tempo limite para confirmação' para acessar seu e-mail e seguir as instruções de confirmação de cadastro."></i>
                                        <div class="controls">
                                            {{ form_widget(form.confirmation_email_block_time) }}
                                            <span style="color: red; position: relative; bottom: 5px;">(Ex. 4d 12h 5m)</span>
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Português: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="pt" data-tag="url">url</a>
                                        </div>
                                        <div class="controls">{{ form_widget(form.content_confirmation_email_pt) }}</div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Inglês: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="en" data-tag="url">url</a>
                                        </div>
                                        <div class="controls">{{ form_widget(form.content_confirmation_email_en) }}</div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Espanhol: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="es" data-tag="url">url</a>
                                        </div>
                                        <div class="controls">{{ form_widget(form.content_confirmation_email_es) }}</div>
                                    </div>
                                </div>

                                <div class="row-fluid sms">
                                    {% if client.isWhiteLabel %}
                                        <div class="control-group">
                                            <p>Na opção de confirmação via <b>SMS</b>, o visitante receberá no celular
                                                cadastrado um código <b>autogerado</b> pelo Hotspot (ex: <b>1234</b>). <br/>
                                                Abaixo, você poderá customizar a mensagem que seu cliente receberá e
                                                escolher em que ponto do texto o nome da sua empresa e o código serão
                                                exibidos<br/>
                                                Exemplo 1: Seja bem vindo à { nome_da_empresa }. Para acessar digite o
                                                código: { codigo }<br/>
                                                Exemplo 2: Bem-vindo à { nome_da_empresa }. Insira o código: { codigo } para
                                                começar a navegar.<br/>
                                                Não é necessário inserir o nome da sua empresa e o código de
                                                confirmação.<br/>
                                                As variáveis <b>{ nome_da_empresa }</b> e <b>{ codigo }</b> automaticamente
                                                serão substituídas pelo nome da sua empresa e código autogerado pelo Hotspot.
                                            </p>
                                        </div>
                                    {% else %}
                                        <div class="control-group">
                                            <p>Na opção de confirmação via <b>SMS</b>, o visitante receberá no celular
                                                cadastrado um código <b>autogerado</b> pelo Mambo WiFi (ex: <b>1234</b>). <br/>
                                                Abaixo, você poderá customizar a mensagem que seu cliente receberá e
                                                escolher em que ponto do texto o nome da sua empresa e o código serão
                                                exibidos<br/>
                                                Exemplo 1: Seja bem vindo à { nome_da_empresa }. Para acessar digite o
                                                código: { codigo }<br/>
                                                Exemplo 2: Bem-vindo à { nome_da_empresa }. Insira o código: { codigo } para
                                                começar a navegar.<br/>
                                                Não é necessário inserir o nome da sua empresa e o código de
                                                confirmação.<br/>
                                                As variáveis <b>{ nome_da_empresa }</b> e <b>{ codigo }</b> automaticamente
                                                serão substituídas pelo nome da sua empresa e código autogerado pelo MamboWiFi.
                                            </p>
                                        </div>
                                    {% endif %}

                                    <div class="control-group">
                                        Conteúdo em Português: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="sms-pt" data-tag="codigo">Clique aqui para adicionar a variável { codigo }</a> <b>- restam <a style="text-decoration: none;" id="ptcount"></a> caracteres</b>
                                        </div>
                                        <div onfocusout="validateAllMessage('#smsValidatePt','#setup_content_confirmation_sms_pt_value')" class="controls">{{ form_widget(form.content_confirmation_sms_pt) }} <p id="smsValidatePt"></p></div><b><u>Atenção: </u>os acentos serão removidos.</b>
                                    </div>

                                    <br>

                                    <div class="control-group">
                                        Conteúdo em Inglês: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="sms-en" data-tag="codigo">Clique aqui para adicionar a variável { codigo }</a> <b>- restam <a style="text-decoration: none;" id="encount"></a> caracteres</b>
                                        </div>
                                        <div onfocusout="validateAllMessage('#smsValidateEn','#setup_content_confirmation_sms_en_value')" class="controls">{{ form_widget(form.content_confirmation_sms_en) }}<p id="smsValidateEn"></p></div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Espanhol: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="sms-es" data-tag="codigo">Clique aqui para adicionar a variável { codigo }</a> <b>- restam <a style="text-decoration: none;" id="escount"></a> caracteres</b>
                                        </div>
                                        <div onfocusout="validateAllMessage('#smsValidateEs','#setup_content_confirmation_sms_es_value')" class="controls">{{ form_widget(form.content_confirmation_sms_es) }}<p id="smsValidateEs"></p></div><b><u>Atención: </u>los acentos se eliminan.</b>
                                    </div>
                                </div>

                                <div class="row-fluid">
                                    <div class="span4">
                                        <div class="control-group sms">
                                            <div class="controls">{{ form_widget(form.confirmation_sms, {"attr":{"class":"hide"}}) }}</div>
                                        </div>
                                    </div>

                                    <div class="span4">
                                        <div class="control-group sms">
                                            <div class="controls">{{ form_widget(form.confirmation_email, {"attr":{"class":"hide"}}) }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}

                    <div class="tab-pane" id="tab4">
                        <h4>Termos de Uso</h4>
                        <br>

                        <div class="control-group">
                            Solicitar leitura dos termos de uso:
                            <span class="tooltip-wrapper">
                                <i class="icon-large icon-question-sign" tabindex="0" data-placement="bottom"
                                   role="button" data-toggle="popover" data-trigger="focus" data-html="true"
                                   data-content="Quando essa opção está ativa, o usuário precisa clicar para informar que está de acordo com os termos de uso para conseguir se cadastrar ou autenticar."></i>
                            </span>
                            <div class="controls">{{ form_widget(form.terms_required) }}</div>
                        </div>
                        <br/>

                        <div class="row-fluid">
                            <div class="widget row-fluid">
                                <div class="widget-head">
                                    <h4 class="heading"> Chamada para os Termos de Uso:</h4>
                                </div>
                                <div class="widget-body">

                                    <div class="control-group">
                                        Conteúdo em Português: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="call_terms_pt" data-tag="use_terms">Termos de Uso</a>
                                        </div>
                                        <div class="controls">
                                            {{ form_widget(form.call_to_terms_pt) }}
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Inglês: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="call_terms_en" data-tag="use_terms">Termos de Uso</a>
                                        </div>
                                        <div class="controls">
                                            {{ form_widget(form.call_to_terms_en) }}
                                        </div>
                                    </div>

                                    <div class="control-group">
                                        Conteúdo em Espanhol: <br>
                                        <div class="placeholder_buttons">
                                            <a href="#" class="call_terms_es" data-tag="use_terms">Termos de Uso</a>
                                        </div>
                                        <div class="controls">
                                            {{ form_widget(form.call_to_terms_es) }}
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                        <br/>

                        <div class="row-fluid">
                            <div class="span6">
                                <div class="widget row-fluid">
                                    <div class="widget-head">
                                        <h4 class="heading"> Português:</h4>
                                    </div>
                                    <div class="widget-body">
                                        {{ form_widget(form.terms_pt_br) }}
                                    </div>
                                </div>
                            </div>

                            <div class="span6">
                                <div class="widget row-fluid">
                                    <div class="widget-head">
                                        <h4 class="heading"> Inglês:</h4>
                                    </div>
                                    <div class="widget-body">
                                        {{ form_widget(form.terms_en) }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row-fluid">
                            <div class="span6">
                                <div class="widget row-fluid">
                                    <div class="widget-head">
                                        <h4 class="heading"> Espanhol:</h4>
                                    </div>
                                    <div class="widget-body">
                                        {{ form_widget(form.terms_es) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% if clientStatus == 2 %}
                        <div class="tab-pane modal fade" id="smsModal" tabindex="-1" role="dialog"
                             aria-labelledby="myModalLabel">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4 class="modal-title">Envio de SMS em teste</h4>
                                    </div>
                                    <div class="modal-body">
                                        Você esta em período de testes, o limite de SMS permitido para envio é
                                        de {{ maxNumberSmsSendingPoc }}. Após isso não será mais enviado SMS.
                                    </div>
                                    <div class="modal-footer">
                                        <a href="#" class="btn btn-default" data-dismiss="modal">Ok entendi!</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="tab-pane modal fade" id="smsModal" tabindex="-1" role="dialog"
                             aria-labelledby="myModalLabel">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h4 class="modal-title">Contrato de envio de SMS</h4>
                                    </div>
                                    <div class="modal-body">
                                        {{ smsCostContract|raw }}
                                    </div>
                                    <div class="modal-footer">
                                        <a href="{{ path('contract_print', { 'id': contract.id }) }}" target="_blank"
                                           class="btn btn-default">Imprimir</a>
                                        <a href="{{ path('configurations_edit', {'groupId' : group.id}) }}"
                                           class="btn btn-default">Não Aceitar</a>
                                        <button id="contractAccept" type="button" class="btn btn-primary"
                                                data-dismiss="modal">Aceitar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}

                    {{ form_errors(form) }}

                    <div class="">
                        <br>
                        {{ form_widget(form.submit) }}
                    </div>
                </div>

                <input name="selectedTab" value="{{ tab }}" type="hidden"/>

                {{ form_end(form) }}
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
{{ parent() }}

<script src="{{ asset('bundles/admin/theme/scripts/plugins/color/farbtastic/farbtastic.js') }}"></script>

<script type="text/javascript">

    function validateAllMessage(idValidate,idMessage){
        var regexPattern = /^[0-9A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ \b{}._:()!?,-]+$/;
        if (!regexPattern.test($(idMessage).val())) {
            $(idValidate).html('Caracteres especiais não são aceitos');
            $(idValidate).addClass('validateLabel');
            submitButtonControl(true, $(this));
        } else {
            $(idValidate).removeClass('validateLabel');
            $(idValidate).empty();
            submitButtonControl(false, $(this));
        }
    }

    function controlSignUpConfirmation(){
        if($('#setup_enable_confirmation_value').prop("checked")){
            $('.signUpConfirmation').removeClass('hide');
        } else {
            $('.signUpConfirmation').addClass('hide');
            smsUnchecked();
            emailUnchecked();
        }
    }

    function smsChecked(){
        $('.row-fluid.sms').show();
        $('.row-fluid.email').hide();
        emailUnchecked();
        $('#setup_confirmation_sms_value').val(1);
        $('#setup_confirmation_sms_value').attr('checked', true);
    }

    function smsUnchecked(){
        $('.row-fluid.sms').hide();
        $('#setup_confirmation_sms_value').removeAttr('checked');
        $('#setup_confirmation_sms_value').val(0);
    }

    function emailChecked(){
        $('.row-fluid.email').show();
        $('.row-fluid.sms').hide();
        smsUnchecked();
        $('#setup_confirmation_email_value').val(1);
        $('#setup_confirmation_email_value').attr('checked', true);
    }

    function emailUnchecked(){
        $('.row-fluid.email').hide();
        $('#setup_confirmation_email_value').removeAttr('checked');
        $('#setup_confirmation_email_value').val(0);
    }

    {% if 'signup_confirmation' in groups %}

    var sms   = {{ (config.confirmation_sms) ? 1 : 0 }};
    var email = {{ (config.confirmation_email) ? 1 : 0 }};

    function controlSmsFields(){
        if(sms == 1){
            smsChecked();
        } else {
            smsUnchecked();
        }
    }

    function checkSmsContract(){
        if($('#setup_confirmation_sms_value').prop("checked")){
            $('#smsModal').modal({
                show: true,
                keyboard: false,
                backdrop: 'static'
            });
        }
    }

    {% endif %}

    function controlEmailFields(){
        if(email == 1){
            emailChecked();
        } else {
            emailUnchecked();
        }
    }

    function controlDivFacebook() {
        if($('#setup_facebook_login_value').prop("checked")) {
            $('.facebookFields').removeClass('hide');
        } else {
            $('.facebookFields').addClass('hide');
            $('#setup_facebook_share_value').removeAttr("checked");
            $('#setup_facebook_like_value').removeAttr("checked");
        }
    }

    function controlFacebookCheckinAndLike(){
        if($('#setup_facebook_share_value').prop("checked")){
            $('.checkinFields').removeClass('hide');
        } else {
            $('.checkinFields').addClass('hide');
        }

        if($('#setup_facebook_like_value').prop('checked')) {
            $('.likeFields').removeClass('hide');
        } else {
            $('.likeFields').addClass('hide');
        }
    }

	function controlAgeRestriction() {
		if ($('#setup_age_restriction_value').prop("checked")) {
			$('.age-restriction-info').removeClass('hide');
		} else {
			$('.age-restriction-info').addClass('hide');
		}
		}

    function controlAuthorizeEmailFields(){
        if($('#setup_authorize_email_value').prop("checked")){
            $('.control-group.authorize-email').removeClass('hide');
        } else {
            $('.control-group.authorize-email').addClass('hide');
        }
    }

    function controlAutoLoginFields(){
        if($('#setup_auto_login_value').prop("checked")){
            $('.control-group.auto-login').removeClass('hide');
        } else {
            $('.control-group.auto-login').addClass('hide');
        }
    }

    $("a[data-toggle='tab']").click(function(){
        var tab         = $(this).attr("href");
        $("input[name='selectedTab']").val(tab);
    });

    $(document).ready(function(){
        var currentLocation = $("input[name='selectedTab']").val();
        var allowed = ["#tab1", "#tab2", "#tab3", "#tab4"];

        if (allowed.indexOf(currentLocation) !== -1) {

            $('.tabsbar li').removeClass('active');
            $('.tab-content .tab-pane').removeClass('active');

            $("a[href='"+currentLocation+"']").parent().addClass('active');
            $(currentLocation).addClass('active');
        }
    });

    $("#validate-facebook-page").click(function()
    {
        var textObject = $("#setup_facebook_page_id_value");
        var label      = $(".label-facebook-page");
        var pageUrl    = textObject.val();

        textObject.attr('disabled', 'disabled');
        label.html("");

        $.ajax({
            type: "POST",
            url: Routing.generate('admin_configuration_facebook_page_validate'),
            data: {
                url: pageUrl
            },
            success: function(response)
            {
                if (response.success == true) {
                    textObject.val(response.page_id);
                    textObject.css('border', '1px solid green');
                } else {
                    textObject.css('border', '1px solid red');
                    label.html(response.message);
                }
                textObject.removeAttr('disabled');
            }
        });
    });

    jQuery('document').ready(function(){

        $('#contractAccept').on('click', function(e){
            e.preventDefault();

            var url = Routing.generate('contract_user_accept', { user: {{ user.id }}, contract: {{ contract.id }} });

            $.ajax({
                type: "POST",
                url: url,
                processData: false,
                contentType: false,
                success: function(response)
                {
                    if(response.error){
                        return false;
                    }
                }
            });
        });

        controlSignUpConfirmation();
        controlSmsFields();
        controlEmailFields();

        $('#setup_enable_confirmation_value').on('change', function(e){
            controlSignUpConfirmation();
        });

        $('.btn-primary.sms').click(function(){
            emailUnchecked();

            $.ajax({
                type: "POST",
                url: Routing.generate('admin_checkSMS_custom_fields', { user: {{ user.id }} }),
                processData: false,
                contentType: false,
                success: function(response)
                {
                    if (!response.allowed)
                    {
                        $("#sms-log")
                            .html('Não há campo para telefone/celular!<br />Você deve cadastrar em \"Customizar Formulários\" ' +
                                'antes de ativar este módulo')
                            .css({ 'color' : '#FF0000', 'font-weight' : 'bold' })
                            .show('slow');

                        setTimeout(function() {
                            $("#sms-log")
                                .html('')
                                .css()
                                .hide('slow');
                        }, 4000);

                        smsUnchecked();

                        return false;
                    }

                    if (!{{ isSmsPocLimited|default('false') }})
                        smsChecked();

                    {% if (userContract is null) %}
                        checkSmsContract();
                    {% endif %}
                }
            });
        });

        $('#setup_enable_welcome_sms_value').on('change', function(e){
            if($('#setup_enable_welcome_sms_value').prop("checked")){
                {% if (userContract is null) %}
                $('#smsModal').modal({
                    show: true,
                    keyboard: false,
                    backdrop: 'static'
                });
                {% endif %}
            }
        });

        $('.btn-primary.email').click(function(){
            emailChecked();
        });

        controlAuthorizeEmailFields();
        controlAutoLoginFields();

        controlDivFacebook();
        controlFacebookCheckinAndLike();
		controlAgeRestriction()

        $('#setup_facebook_login_value').on('change', function(e){
            controlDivFacebook();
        });

        $('#setup_facebook_share_value').on('change', function(e){
            controlFacebookCheckinAndLike();
        });

        $('#setup_facebook_like_value').on('change', function(e){
            controlFacebookCheckinAndLike();
        });

        $('#setup_authorize_email_value').on('change', function(e){
            controlAuthorizeEmailFields();
        });

        $('#setup_auto_login_value').on('change', function(e){
            controlAutoLoginFields();
        });

		$('#setup_age_restriction_value').on('change', function (e) {
			controlAgeRestriction();
		});

        function removeAccentuation(string) {
            accents   = '.|áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ';
            replaced  = '.|aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC';
            newString = '';

            for(i=0;i<string.length;i++) {
                if (accents.search(string.substr(i,1))>=0) {
                    newString+=replaced.substr(accents.search(string.substr(i,1)),1);
                }
                else {
                    newString+=string.substr(i,1);
                }
            }
            return newString;
        }

        $('#setup_content_confirmation_sms_pt_value').on('keypress', function(e){
            $(this).val(removeAccentuation($(this).val()));
            countingWords(this, '#ptcount',{{ partnerNameSize.pt }});
        });

        $('#setup_content_confirmation_sms_en_value').on('keypress', function(e){
            $(this).val(removeAccentuation($(this).val()));
            countingWords(this, '#encount', {{ partnerNameSize.en }});
        });

        $('#setup_content_confirmation_sms_es_value').on('keypress', function(e){
            $(this).val(removeAccentuation($(this).val()));
            countingWords(this, '#escount', {{ partnerNameSize.es }});
        });

        $('#ptcount').text((160 - {{ partnerNameSize.pt }}) - $('#setup_content_confirmation_sms_pt_value').val().length);
        $('#encount').text((160 - {{ partnerNameSize.en }}) - $('#setup_content_confirmation_sms_en_value').val().length);
        $('#escount').text((160 - {{ partnerNameSize.es }}) - $('#setup_content_confirmation_sms_es_value').val().length);

        function countingWords(element, counter,LenName)
        {
            var len = $(element).val().length;
            var contTot = LenName + len;
            if (len >= 160) {
                $(counter).text(0);
            }

            $(counter).text(160 - contTot);
        }

        $('.placeholder_buttons a').click(function(e){

            var phTargetItem = $(this).attr('class');

            var tav    = $('.placeholder_'+ phTargetItem).val(),
                    strPos = $('.placeholder_'+ phTargetItem)[0].selectionStart;

            front  = (tav).substring(0,strPos),
                    back   = (tav).substring(strPos,tav.length);

            $('.placeholder_'+ phTargetItem).val(front + '{ ' + $(this).data('tag') + ' }' + back);

            var new_val = $('.placeholder_'+ phTargetItem).val();

            $('.placeholder_'+ phTargetItem).focus().val('').val(new_val);

            return false;
        });

    });

    jQuery.extend(jQuery.validator.messages, {
        email: "Informe um email no formato válido. Ex: teste@seudominio.com.br"
    });

    //numero maximo de caracter de acordo com o nome da empresa
    var maxlengthSmsPt = 160 - {{ partnerNameSize.pt }};
    var maxlengthSmsEn = 160 - {{ partnerNameSize.en }};
    var maxlengthSmsEs = 160 - {{ partnerNameSize.es }};

     $(document).ready(function(){
        $("#setup_content_confirmation_sms_pt_value").attr('maxlength',maxlengthSmsPt);
        $("#setup_content_confirmation_sms_en_value").attr('maxlength',maxlengthSmsEn);
        $("#setup_content_confirmation_sms_es_value").attr('maxlength',maxlengthSmsEs);
    });

    $('#setup_content_confirmation_sms_pt_value').on('blur keypress keyup keydown', function(e){
        var erroSmsPt = $('#setup_content_confirmation_sms_pt_value-error');
        erroSmsPt.html('Por favor introduza no máximo ' + maxlengthSmsPt + ' caracteres ou diminua o nome da empresa.');
    });

    $('#setup_content_confirmation_sms_es_value').on('blur keypress keyup keydown', function(e){
        var erroSmsEs = $('#setup_content_confirmation_sms_es_value-error');
        erroSmsEs.html('Por favor introduza no máximo ' + maxlengthSmsEs + ' caracteres ou diminua o nome da empresa.');
    });

    $('#setup_content_confirmation_sms_en_value').on('blur keypress  keydown ', function(e){
        var erroSmsEn = $('#setup_content_confirmation_sms_en_value-error');
        erroSmsEn.html('Por favor introduza no máximo ' + maxlengthSmsEn + ' caracteres ou diminua o nome da empresa.');
    });

    $('#setup_submit').on('blur keypress  keydown click', function(e){
        var erroSmsPt = $('#setup_content_confirmation_sms_pt_value-error');
        erroSmsPt.html('Por favor introduza no máximo ' + maxlengthSmsPt + ' caracteres ou diminua o nome da empresa.');

        var erroSmsEs = $('#setup_content_confirmation_sms_es_value-error');
        erroSmsEs.html('Por favor introduza no máximo ' + maxlengthSmsEs + ' caracteres ou diminua o nome da empresa.');

        var erroSmsEn = $('#setup_content_confirmation_sms_en_value-error');
        erroSmsEn.html('Por favor introduza no máximo ' + maxlengthSmsEn + ' caracteres ou diminua o nome da empresa.');
    });

    // aqui faço o Evento OnKeyUp separa, porque junto nao estava dando certo
    $(document).keyup(function(event) {
         var erroSmsPt = $('#setup_content_confirmation_sms_pt_value-error');
         erroSmsPt.html('Por favor introduza no máximo ' + maxlengthSmsPt + ' caracteres ou diminua o nome da empresa.');

         var erroSmsEs = $('#setup_content_confirmation_sms_es_value-error');
         erroSmsEs.html('Por favor introduza no máximo ' + maxlengthSmsEs + ' caracteres ou diminua o nome da empresa.');

         var erroSmsEn = $('#setup_content_confirmation_sms_en_value-error');
         erroSmsEn.html('Por favor introduza no máximo ' + maxlengthSmsEn + ' caracteres ou diminua o nome da empresa.');
    });
</script>

{% include 'AdminBundle::alerts.js.twig' %}
{% endblock %}
